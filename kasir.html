<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kasir Es Teh Delok Horeg</title>
  <style>
    body {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: #ffffff;}
    header {background: #d4af37; color: white; padding: 15px; text-align: center; font-size: 22px; font-weight: bold;}
    nav {background: #b89628; padding: 10px; text-align: center;}
    nav a {color: white; margin: 0 10px; text-decoration: none; font-weight: 500;}
    nav a:hover {text-decoration: underline;}
    .container {max-width: 1000px; margin: 20px auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);}
    h2 {margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; color: #b89628;}
    .row {display: flex; gap: 20px; margin-top: 20px;}
    .col {flex: 1;}
    label {display: block; margin-top: 10px; font-weight: 500; color: #444;}
    input, select {width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;}
    button {margin-top: 15px; width: 100%; padding: 12px; border: none; border-radius: 6px; background: #d4af37; color: #fff; font-size: 15px; font-weight: bold; cursor: pointer; transition: 0.3s;}
    button:hover {background: #b89628;}
    .result, .stok, .penghasilan, .pembayaran {margin-top: 20px; padding: 15px; background: #fdfbf7; border-radius: 8px; border: 1px solid #d4af37;}
    .stok-list {margin-top: 10px; max-height: 400px; overflow-y: auto;}
    .stok-item {padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; font-size: 14px;}
    .stok-item:last-child {border-bottom: none;}
    .highlight {font-size: 18px; font-weight: bold; color: #d4af37;}
    footer {margin-top: 30px; text-align: center; padding: 15px; color: #b89628; font-size: 14px; background: #fff; border-top: 1px solid #eee;}
    .hidden {display: none;}
    .danger {background: #ff4d4d;}
    .danger:hover {background: #cc0000;}
  </style>
</head>
<body>
  <header>Sistem Kasir Supermarket</header>
  <nav>
    <a href="#" onclick="showPage('penjualan')">Penjualan</a>
    <a href="#" onclick="showPage('stok')">Stok Produk</a>
  </nav>

  <div id="penjualan" class="container">
    <h2>Transaksi Penjualan</h2>
    <div class="row">
      <div class="col">
        <label for="produkSelect">Pilih Produk</label>
        <select id="produkSelect" onchange="pilihProduk()">
          <option value="">-- Pilih Produk --</option>
        </select>

        <label for="harga">Harga per Barang (Rp)</label>
        <input type="number" id="harga" placeholder="Harga otomatis" readonly />

        <label for="jumlah">Jumlah Barang Keluar (Terjual)</label>
        <input type="number" id="jumlah" placeholder="Masukkan jumlah barang terjual" />

        <button onclick="jualProduk()">Proses Penjualan</button>
      </div>
      <div class="col">
        <div class="result" id="hasil">Total: Rp 0</div>
        <div class="pembayaran hidden" id="pembayaranBox">
          <label for="uangDiterima">Uang Diterima (Rp)</label>
          <input type="number" id="uangDiterima" placeholder="Masukkan jumlah uang dari pembeli" />
          <button onclick="hitungKembalian()">Hitung Kembalian</button>
          <div id="kembalian" class="highlight"></div>
        </div>
        <div class="penghasilan">
          <strong>Total Penghasilan</strong>
          <div id="totalPenghasilan" class="highlight">Rp 0</div>
          <button class="danger" onclick="resetPenghasilan()">Reset Penghasilan</button>
        </div>
      </div>
    </div>
  </div>

  <div id="stok" class="container hidden">
    <h2>Manajemen Stok Produk</h2>
    <label for="stokNama">Nama Produk</label>
    <input type="text" id="stokNama" placeholder="Contoh: Indomie Goreng" />

    <label for="stokHarga">Harga per Barang (Rp)</label>
    <input type="number" id="stokHarga" placeholder="Masukkan harga barang" />

    <label for="stokMasuk">Tambah Stok Masuk</label>
    <input type="number" id="stokMasuk" placeholder="Jumlah barang masuk" />
    <button onclick="tambahStok()">Tambah Produk / Stok</button>

    <div class="stok">
      <div class="stok-list" id="stokList">Belum ada data produk.</div>
    </div>

    <button class="danger" onclick="resetStok()">Reset Semua Stok</button>
  </div>

  <footer>© 2025 Sistem Kasir Supermarket</footer>

  <script>
    let stok = JSON.parse(localStorage.getItem('stokProduk') || '{}');
    let penghasilan = parseInt(localStorage.getItem('penghasilan') || '0');
    let totalTransaksi = 0;

    function simpanStok() {
      localStorage.setItem('stokProduk', JSON.stringify(stok));
      renderStok();
      renderDropdown();
    }

    function renderStok() {
      const list = document.getElementById('stokList');
      list.innerHTML = '';
      const keys = Object.keys(stok);
      if (keys.length === 0) {
        list.textContent = 'Belum ada data produk.';
        return;
      }
      keys.forEach(nama => {
        const item = stok[nama];
        const div = document.createElement('div');
        div.className = 'stok-item';
        div.innerHTML = `<span><b>${nama}</b> | Stok: ${item.stok} | Harga: Rp ${item.harga.toLocaleString('id-ID')}</span>
                         <span>Masuk: ${item.masuk} | Keluar: ${item.keluar}</span>`;
        list.appendChild(div);
      });
      document.getElementById('totalPenghasilan').textContent = 'Rp ' + penghasilan.toLocaleString('id-ID');
    }

    function renderDropdown() {
      const select = document.getElementById('produkSelect');
      select.innerHTML = '<option value="">-- Pilih Produk --</option>';
      Object.keys(stok).forEach(nama => {
        const option = document.createElement('option');
        option.value = nama;
        option.textContent = nama;
        select.appendChild(option);
      });
    }

    function pilihProduk() {
      const nama = document.getElementById('produkSelect').value;
      if (nama && stok[nama]) {
        document.getElementById('harga').value = stok[nama].harga;
      } else {
        document.getElementById('harga').value = '';
      }
    }

    function jualProduk() {
      const nama = document.getElementById('produkSelect').value;
      const jumlah = parseInt(document.getElementById('jumlah').value) || 0;

      if (!nama || jumlah <= 0) {
        alert('Pilih produk dan isi jumlah dengan benar.');
        return;
      }

      if (!stok[nama]) {
        alert('Produk tidak ditemukan di stok. Tambahkan produk terlebih dahulu.');
        return;
      }

      if (stok[nama].stok < jumlah) {
        alert('Stok tidak mencukupi!');
        return;
      }

      stok[nama].stok -= jumlah;
      stok[nama].keluar += jumlah;

      totalTransaksi = jumlah * stok[nama].harga;
      penghasilan += totalTransaksi;

      document.getElementById('hasil').textContent = 'Total: Rp ' + totalTransaksi.toLocaleString('id-ID');
      document.getElementById('pembayaranBox').classList.remove('hidden');

      localStorage.setItem('penghasilan', penghasilan);
      simpanStok();
    }

    function hitungKembalian() {
      const uangDiterima = parseInt(document.getElementById('uangDiterima').value) || 0;
      if (uangDiterima < totalTransaksi) {
        document.getElementById('kembalian').textContent = '⚠️ Uang kurang Rp ' + (totalTransaksi - uangDiterima).toLocaleString('id-ID');
        document.getElementById('kembalian').style.color = 'red';
      } else {
        const kembalian = uangDiterima - totalTransaksi;
        document.getElementById('kembalian').textContent = 'Kembalian: Rp ' + kembalian.toLocaleString('id-ID');
        document.getElementById('kembalian').style.color = '#d4af37';
      }
    }

    function tambahStok() {
      const nama = document.getElementById('stokNama').value.trim();
      const harga = parseInt(document.getElementById('stokHarga').value) || 0;
      const masuk = parseInt(document.getElementById('stokMasuk').value) || 0;

      if (!nama || harga <= 0 || masuk <= 0) {
        alert('Isi nama, harga, dan jumlah masuk dengan benar.');
        return;
      }

      if (!stok[nama]) {
        stok[nama] = { harga: harga, stok: 0, keluar: 0, masuk: 0 };
      }

      stok[nama].stok += masuk;
      stok[nama].masuk += masuk;
      stok[nama].harga = harga;

      simpanStok();
    }

    function resetStok() {
      if (confirm('Apakah Anda yakin ingin mereset semua stok produk?')) {
        stok = {};
        localStorage.removeItem('stokProduk');
        renderStok();
        renderDropdown();
      }
    }

    function resetPenghasilan() {
      if (confirm('Apakah Anda yakin ingin mereset total penghasilan?')) {
        penghasilan = 0;
        localStorage.setItem('penghasilan', penghasilan);
        document.getElementById('totalPenghasilan').textContent = 'Rp 0';
      }
    }

    function showPage(page) {
      document.getElementById('penjualan').classList.add('hidden');
      document.getElementById('stok').classList.add('hidden');
      document.getElementById(page).classList.remove('hidden');
    }

    renderStok();
    renderDropdown();
  </script>
</body>
</html>
